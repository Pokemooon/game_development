## 开发周期：2022/03/07-2022/04/30

题目：基于Unity的3D闯关类游戏

开发期限：5周~8周，待议。**如果是8周，则4月30号结束；如果5周，则4月9号结束。**

涉及技术：Unity，C#，SQL，Scrum，UWP，UML，HTTP，Go

---

### Introduction

- 本软件是基于Unity框架下的多人闯关综艺游戏，类似于男生女生向前冲
- 支持本地游戏和网络端联机两种游玩
- 支持Win和Android平台
- 游戏本体除了基本的闯关胜利机制外，具有创意工坊和成就系统
  - 游戏本体：类似保卫萝卜形式的官方地图过关模式，一关结束进入下一关
  - 创意工坊：支持玩家自定义皮肤和自定义地图
  - 成就系统：解锁制作皮肤和地图的器件

- 学习涉及技术的掌握程度：

| 关键技术 | 要求                      |
| -------- | ------------------------- |
| C#       | 精通（Any）               |
| Unity    | 熟练（客户端部分）        |
| MySQL    | 熟练（服务器&客户端部分） |
| Go       | 熟练（服务器部分）        |
| HTTP     | 熟练（服务器部分）        |

- 开发难点：

  1. 糖豆人的物理效果模拟。

  2. 联机模式下对不同玩家的数据进行同步。

  3. 将用户的数据保存在服务器。

  4. Android平台与PC平台的数据互通。

  5. 设计可以使玩家自由设计关卡的地图工坊。

---

### Software agent

#### 预期功能：

1. 用户可以进行注册个人信息，登陆，找回密码等基础操作。用户的个人信息及游戏内资料存到等可以保存在服务器上，或保存到个人设备中。

2. 游戏平台提供多人联机模式，可以进行实时对抗。

3. 按照游戏指定要求完成关卡，可以获得对应“成就”。

4. 根据游戏进度及“成就”可以解锁皮肤、兑换游戏金币等。

5. 设置游戏空间，玩家可自行编辑关卡并发布，与他人分享。

   ---

#### 软件质量

- [ ] 实现玩家的注册和个人信息的保存

- [ ] 完成单人模式

- [ ] 完成多人联机模式

- [ ] 完成成就系统以及商城系统

- [ ] 设计的皮肤数量

- [ ] 设计的关卡数量

  ---

#### 用例建模（对照文件夹中的图片看）

- 用例包括两个部分：

  1. 游客的用例：登录，注册，游玩单机模式。

  2. 已注册用户的用例：获取与制作皮肤和地图，创建和加入在线模式，游玩单机模式。

- 用例详述：

  1. 登录用例：注册账户，会员登录
  2. 地图相关用例：选择本地地图，查看在线地图，下载在线地图，赞赏在线地图
  3. 皮肤相关用例：选择本地皮肤，查看在线皮肤，下载在线皮肤
  4. 设置用例：设置音量，设置音效，窗口化设置
  5. 多人模式用例：创建房间，加入房间，选择房间地图，房间内聊天

- 扮演者详述：

  1. 游客

     ​	可以直接游玩本地的地图，可赚取货币，可用货币购买皮肤，可制作本地地图及本地皮肤。

  2. 会员

     ​	可以创建或加入在线模式，可将本地的地图和皮肤上传到创意工坊，可在创意工坊下载地图和皮肤。可将成绩上传，也可以查看他人成绩。

     ---

#### 模块设计

**概念定义：**

- 皮肤：为游戏角色替换造型
- 货币：通过成就解锁，游戏中虚拟货币，可用于购买皮肤、购买地图器件等

**登录模块：**

- 概要：登录、注册、验证码
- 说明：用户被视为登录模块的使用者，在使用者登录系统时，只有根据自己的用户名和登陆密码成功后，才能在自己需要的用户界面或者管理员界面进行后续的操作。系统只允许收入到数据库中的人员进行登录，若用户名或密码输入不正确，将无法进入系统。根据数据库中已经存在的表的信息进行查询，判断用户名和密码是否正确，如果正确则登录成功进入到相应的显示界面，如果数据匹配失败，则停留在当前界面等待输入，提示用户名和密码不匹配。

**网络模块:**

- 网络管理、状态同步

**相机控制模块：**

- 概要：相机与角色的视角切换
- 说明：使相机始终跟随玩家，提供最好的视角，并且尽可能使视角移动平滑。
- 输入：玩家鼠标操作
- 输出：视角的变换

**关卡模块：**

- 概要：跷跷板、大摆锤、大转盘、传送带
- 说明：此游戏的关卡设计需要大量的障碍道具，比如大转盘、跷跷板、大摆锤、传送带等道具。关卡模块主要包含关卡设计中用到的各种预制件和控件
- 输入：与玩家的交互
- 输出：关卡模块的反馈

**玩家模块：**

- 概要：游客、已登录用户
- 说明：此游戏的玩家操纵一个角色，玩家通过WASD移动角色。此模块的功能主要实现了角色的受力反馈、跳跃、碰撞和减速等功能，并且实时上传当前玩家的同步状态给网络模块进行同步。
- 输入：玩家键盘输入
- 输出：小球做出的反馈

**接口统一：**

| 模块名称     | I(输入)          | P(处理)                                | O(输出)                  |
| ------------ | ---------------- | -------------------------------------- | ------------------------ |
| 登录模块     | 用户输入账号信息 | 将用户输入的账号信息与本地账号信息比对 | 是否登录成功             |
| 网络模块     | 客户端玩家状态   | 将所有客户端玩家状态同步               | 将同步后的状态反馈给玩家 |
| 关卡模块     | 玩家动作交互     | 进行碰撞处理                           | 效果反馈                 |
| 玩家模块     | 键盘输入         | 将键盘输入映射为小球动作               | 小球运动状态改变         |
| 相机控制模块 | 鼠标输入         | 将鼠标输入转换为视角变换               | 视角变换                 |

---

#### 数据库设计

**一、系统数据库表**

| 序号 | 表名(英文) | 说明       |
| ---- | ---------- | ---------- |
| 1    | tourist    | 游客信息表 |
| 2    | member     | 会员信息表 |
| 3    | skins      | 皮肤表     |

（1）游客信息表

| 属性(英文) | 类型 | 主键 | 外键 | 空值 | 属性(中文) |
| ---------- | ---- | ---- | ---- | ---- | ---------- |
| U_id       | Int  | Yes  |      |      | 记录ID     |
| U_money    | Int  | No   | No   | No   | 金钱       |
| U_skin     | Int  | No   | No   | No   | 皮肤列表   |

（1）会员信息表

| 属性(英文) | 类型         | 主键 | 外键 | 空值 | 属性(中文) |
| ---------- | ------------ | ---- | ---- | ---- | ---------- |
| M_id       | Int          | Yes  |      |      | 记录ID     |
| M_money    | Int          | No   | No   | No   | 金钱       |
| M_skin     | Int          | No   | No   | No   | 皮肤列表   |
| M_key      | Int          | No   | No   | No   | 密码       |
| M_name     | varChar(100) |      |      | Yes  | 用户名     |

（1）皮肤表

| 属性(英文) | 类型 | 主键 | 外键 | 空值 | 属性(中文) |
| ---------- | ---- | ---- | ---- | ---- | ---------- |
| S_id       | Int  | Yes  |      |      | 记录ID     |
| S_address  | Int  | No   | No   | No   | 皮肤地址   |


---

### Post distribution

| 职位             | 简要说明                                                     | 分工  | 姓名                         |
| :--------------- | ------------------------------------------------------------ | ----- | ---------------------------- |
| 登录模块实现     | 参考上面                                                     | 1-2人 | 王若冰、徐欣欣               |
| 相机控制模块实现 | 参考上面                                                     | 1人   | 贾立宇                       |
| 关卡模块实现     | 关卡模块主要包含关卡设计中用到的各种预制件和控件。           | 3-4人 | 贾立宇、赵一鸣、张俊鹏       |
| 玩家模块实现     | 实时上传当前玩家的同步状态给网络模块进行同步。               | 3-4人 | 姚睿、贾立宇、徐欣欣、王若冰 |
| 创意工坊实现     | 本地制作地图、皮肤等，并控制上传                             | 3-4人 | 贾立宇、赵一鸣、王若冰       |
| UI润色           | 进行软件的后续润色包装等等                                   | 1-2人 | 张俊鹏、张晓发               |
| 系统测试（白盒） | 地图预览、游戏游玩：开始、检查点、存档点、选项卡、终点、成功、失败 | 1人   | 姚睿                         |
| 系统测试（黑盒） | GPU、帧数                                                    | 1人   | 张晓发                       |



---

### Development phase

- 第一阶段是基本功能实现，该阶段应能基本完成，制作出第一个地图，并完成游戏在PC端的核心功能。

- 第二阶段在对第一阶段成果进行测试与修改的同时，增加联机，商店系统和成就系统。
- 第三阶段增加地图工坊功能并设计更多地图以及开发游戏的Android版本。
- 第四阶段是系统的稳定性测试。

| 阶段     | 迭代次数 | 开始日期 | 结束日期 |
| -------- | -------- | -------- | -------- |
| 先启阶段 | 1        | 第1周    | 第2周    |
| 精化阶段 | 3        | 第2周    | 第3周    |
| 扩展阶段 | 1        | 第3周    | 第4周    |
| 测试阶段 | 2        | 第4周    | 第5周    |

